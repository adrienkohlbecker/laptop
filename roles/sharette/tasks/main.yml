---

- name: Ensure sharette directory is present
  file:
    path: ~/Desktop/sharette
    state: directory
  tags:
    - sharette

- name: Ensure secure_files directory is present
  file:
    path: ~/Desktop/sharette
    state: directory
  tags:
    - sharette

- name: Ensure sublime project is present
  copy:
    src: sharette.sublime-project
    dest: ~/Desktop/sharette/sharette.sublime-project
  tags:
    - sharette

- name: Link sharette to GOPATH
  file:
    src: ~/Desktop/sharette
    path: "{{ gopath }}/src/github.com/sharette"
    state: link
  tags:
    - sharette

- name: Install dev box
  shell: "/usr/local/bin/vagrant box list | grep -q sharette || /usr/local/bin/vagrant box add http://box.shr.st --provider parallels"
  changed_when: false
  tags:
    - sharette

- name: Tap sharette/tap
  homebrew_tap:
    tap: sharette/tap
  tags:
    - apps

- name: Install shr-menu
  homebrew_cask:
    name: shr-menu
  tags:
    - apps

- name: Start shr-menu at login
  shell: >
    osascript -e 'tell application "System Events" to make new login item at end with properties {path:"{{ brew_cask_install_directory }}/shr.app", name:"shr", hidden:true}'
  changed_when: false
  tags:
    - apps

- name: Open shr-menu
  shell: "open -a {{ brew_cask_install_directory }}/shr.app"
  changed_when: false
  tags:
    - apps
